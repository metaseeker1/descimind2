{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { elizaLogger } from \"@ai16z/eliza\";\nimport {\n    Action,\n    HandlerCallback,\n    IAgentRuntime,\n    Memory,\n    Plugin,\n    State,\n} from \"@ai16z/eliza\";\nimport { generateWebSearch } from \"@ai16z/eliza\";\n\nimport { SearchResult } from \"@ai16z/eliza\";\n\nconst webSearch: Action = {\n    name: \"WEB_SEARCH\",\n    similes: [\n        \"SEARCH_WEB\",\n        \"INTERNET_SEARCH\",\n        \"LOOKUP\",\n        \"QUERY_WEB\",\n        \"FIND_ONLINE\",\n        \"SEARCH_ENGINE\",\n        \"WEB_LOOKUP\",\n        \"ONLINE_SEARCH\",\n        \"FIND_INFORMATION\",\n    ],\n    description:\n        \"Perform a web search to find information related to the message.\",\n    validate: async (runtime: IAgentRuntime, message: Memory) => {\n        const tavilyApiKeyOk = !!runtime.getSetting(\"TAVILY_API_KEY\");\n\n        return tavilyApiKeyOk;\n    },\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State,\n        options: any,\n        callback: HandlerCallback\n    ) => {\n        elizaLogger.log(\"Composing state for message:\", message);\n        state = (await runtime.composeState(message)) as State;\n        const userId = runtime.agentId;\n        elizaLogger.log(\"User ID:\", userId);\n\n        const webSearchPrompt = message.content.text;\n        elizaLogger.log(\"web search prompt received:\", webSearchPrompt);\n\n        elizaLogger.log(\"Generating image with prompt:\", webSearchPrompt);\n        const searchResponse = await generateWebSearch(\n            webSearchPrompt,\n            runtime\n        );\n\n        if (searchResponse && searchResponse.results.length) {\n            const responseList = searchResponse.answer\n                ? `${searchResponse.answer}${\n                      Array.isArray(searchResponse.results) &&\n                      searchResponse.results.length > 0\n                          ? `\\n\\nFor more details, you can check out these resources:\\n${searchResponse.results\n                                .map(\n                                    (result: SearchResult, index: number) =>\n                                        `${index + 1}. [${result.title}](${result.url})`\n                                )\n                                .join(\"\\n\")}`\n                          : \"\"\n                  }`\n                : \"\";\n\n            callback({\n                text: responseList,\n            });\n        } else {\n            elizaLogger.error(\"search failed or returned no data.\");\n        }\n    },\n    examples: [\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Find the latest news about SpaceX launches.\",\n                },\n            },\n            {\n                user: \"{{agentName}}\",\n                content: {\n                    text: \"Here is the latest news about SpaceX launches:\",\n                    action: \"WEB_SEARCH\",\n                },\n            },\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Can you find details about the iPhone 16 release?\",\n                },\n            },\n            {\n                user: \"{{agentName}}\",\n                content: {\n                    text: \"Here are the details I found about the iPhone 16 release:\",\n                    action: \"WEB_SEARCH\",\n                },\n            },\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"What is the schedule for the next FIFA World Cup?\",\n                },\n            },\n            {\n                user: \"{{agentName}}\",\n                content: {\n                    text: \"Here is the schedule for the next FIFA World Cup:\",\n                    action: \"WEB_SEARCH\",\n                },\n            },\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: { text: \"Check the latest stock price of Tesla.\" },\n            },\n            {\n                user: \"{{agentName}}\",\n                content: {\n                    text: \"Here is the latest stock price of Tesla I found:\",\n                    action: \"WEB_SEARCH\",\n                },\n            },\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"What are the current trending movies in the US?\",\n                },\n            },\n            {\n                user: \"{{agentName}}\",\n                content: {\n                    text: \"Here are the current trending movies in the US:\",\n                    action: \"WEB_SEARCH\",\n                },\n            },\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"What is the latest score in the NBA finals?\",\n                },\n            },\n            {\n                user: \"{{agentName}}\",\n                content: {\n                    text: \"Here is the latest score from the NBA finals:\",\n                    action: \"WEB_SEARCH\",\n                },\n            },\n        ],\n        [\n            {\n                user: \"{{user1}}\",\n                content: { text: \"When is the next Apple keynote event?\" },\n            },\n            {\n                user: \"{{agentName}}\",\n                content: {\n                    text: \"Here is the information about the next Apple keynote event:\",\n                    action: \"WEB_SEARCH\",\n                },\n            },\n        ],\n    ],\n} as Action;\n\nexport const webSearchPlugin: Plugin = {\n    name: \"webSearch\",\n    description: \"Search web\",\n    actions: [webSearch],\n    evaluators: [],\n    providers: [],\n};\n"],"mappings":"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","names":[]}